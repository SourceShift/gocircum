doh_providers:
  - name: "dynamic_discovery"
    discovery_mode: "multi_channel"
    dga_config:
      algorithm: "sha256_based"
      seed_rotation_hours: 6
      domain_count: 50
      tlds: ["com", "net", "org", "info", "xyz", "top", "site"]
    steganographic_channels:
      - platform: "twitter"
        account_pattern: "@tech_support_[0-9]{4}"
        extraction_pattern: "update.*?([a-zA-Z0-9.-]+)"
      - platform: "github"
        repo_pattern: "config-updates/dns-helpers"
        file_pattern: "*.json"
    peer_discovery:
      enabled: true
      bootstrap_peers: []  # Will be populated by other methods
      discovery_protocol: "gossip"
    fallback_providers:
      obfuscated_endpoints:
        - domain: "api.random-service-1.com"
          path: "/v1/resolve"
          disguise_as: "weather_api"
        - domain: "cdn.example-cdn.net" 
          path: "/dns"
          disguise_as: "asset_api"

canary_domains:
  - "www.cloudflare.com"
  - "www.google.com"
  - "www.amazon.com"
  - "www.microsoft.com"
  - "www.apple.com"

fingerprints:
  - id: "df_google_utls_randomized"
    description: "Domain Fronting via Google with uTLS (Randomized)"
    domain_fronting:
      enabled: true
      front_domain: "www.google.com:443"
      covert_target: "www.youtube.com"
    transport:
      protocol: "tcp"
    tls:
      library: "utls"
      client_hello_id: "HelloRandomized"
      min_version: "1.3"
      max_version: "1.3"

  - id: "df_google_utls_chrome"
    description: "Domain Fronting via Google with uTLS Chrome"
    domain_fronting:
      enabled: true
      front_domain: "www.google.com:443"
      covert_target: "www.youtube.com"
    transport:
      protocol: "tcp"
    tls:
      library: "utls"
      client_hello_id: "HelloChrome_Auto"
      user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36"
      min_version: "1.3"
      max_version: "1.3"

  - id: "df_google_fragment_utls_firefox"
    description: "Domain Fronting (Google) with fragmentation and uTLS Firefox"
    domain_fronting:
      enabled: true
      front_domain: "www.google.com:443"
      covert_target: "www.youtube.com"
    transport:
      protocol: "tcp"
      fragmentation:
        algorithm: "static"
        packet_sizes:
          - [10, 20]
          - [30, 50]
        delay_ms: [5, 15]
    tls:
      library: "utls"
      client_hello_id: "HelloFirefox_Auto"
      min_version: "1.3"
      max_version: "1.3"

  - id: "df_google_fragment_even_utls_safari"
    description: "Domain Fronting (Google) with even fragmentation and uTLS Safari"
    domain_fronting:
      enabled: true
      front_domain: "www.google.com:443"
      covert_target: "www.youtube.com"
    transport:
      protocol: "tcp"
      fragmentation:
        algorithm: "even"
        packet_sizes:
          - [3, 3]
        delay_ms: [10, 30]
    tls:
      library: "utls"
      client_hello_id: "HelloSafari_Auto"
      min_version: "1.3"
      max_version: "1.3"

  - id: "df_amazon_utls_chrome"
    description: "Domain Fronting via Amazon with uTLS Chrome"
    domain_fronting:
      enabled: true
      front_domain: "a0.awsstatic.com"
      covert_target: "www.amazon.com"
    transport:
      protocol: "tcp"
    tls:
      library: "utls"
      client_hello_id: "HelloChrome_Auto"
      user_agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36"
      min_version: "1.3"
      max_version: "1.3" 